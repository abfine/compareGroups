\documentclass[11pt]{article}
%\usepackage[authoryear,round]{natbib}
\usepackage[ansinew]{inputenc}
\usepackage{hyperref}
\usepackage[pdftex]{color,graphicx,epsfig}
\DeclareGraphicsRule{.pdftex}{pdf}{.pdftex}{}
\usepackage{amssymb,amsmath}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage{lscape}
\usepackage{longtable}
\usepackage{color}
\usepackage{fancyvrb}
\usepackage{enumerate}
\usepackage{float}
\usepackage{setspace}

\newcommand{\Rlogo}{\protect\includegraphics[height=1.8ex,keepaspectratio]{./figures/Rlogo.pdf}}
\newenvironment{itemize*}%
  {\begin{itemize}%
    \setlength{\itemsep}{-0.35cm}%
    \setlength{\parskip}{10pt}}%
  {\end{itemize}}
\usepackage{Sweave}
\usepackage[pdftex]{graphicx}
\usepackage{tikz} % paquete para flow-chart
\usetikzlibrary{shapes,arrows} % paquete para dibujar clouds, elipse, 
\usepackage[a4paper,left=2cm,right=2cm,top=1.5cm,bottom=1.5cm]{geometry}

\definecolor{Soutput*}{rgb}{1,0,0}
\DefineVerbatimEnvironment{Verbatim*}{Verbatim}{formatcom={\color{Soutput*}},fontsize=\scriptsize \selectfont}


\definecolor{Scode*}{rgb}{0,0,1}
\DefineVerbatimEnvironment{Verbatim**}{Verbatim}{formatcom={\color{Scode*}},fontsize=\normalsize \selectfont}

\newenvironment{changemargin1}{
  \begin{list}{}{
    \setlength{\leftmargin}{+5cm}
    \setlength{\rightmargin}{3cm}
    \footnotesize
  }
  \item[]
  }{\end{list}}






\begin{document}
\input{compareGroups_vignette-concordance}
\input{compareGroups_vignette-concordance}


\title{\Large \bf {\tt compareGroups} 2.0: Descriptives by groups \\ \vspace{0.5cm}}



\author{Isaac Subirana$^{3,1,4}$ , Joan Vila$^{1,3}$ and H\'ector Sanz$^{2,1}$}
%\VignetteIndexEntry{compareGroups}

\maketitle

\begin{scriptsize}
\noindent $^{1}$Cardiovascular Epidemiology \& Genetics group, Inflammatory and Cardiovascular Disease Programme, IMIM, Barcelona \\
$^{2}$Barcelona Centre for International Health Research (CRESIB, Hospital Clínic-Universitat de Barcelona), Barcelona, Spain \\
$^{3}$CIBER Epidemiology and Public Health (CIBERESP), Spain \\
$^{4}$Statistics Department, University of Barcelona, Spain \\
\end{scriptsize} 


\begin{center}
\texttt{isubirana@imim.es}, \texttt{jvila@imim.es}, \texttt{hsrodenas@gmail.com}
\end{center}

\vspace{0.5cm}

\tableofcontents

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction} \label{section-Introduction}

The \textbf{{\tt compareGroups}} package allows users to create tables displaying results of univariate analyses, stratified or not by categorical variable groupings.\\


Tables can easily be exported to CSV, \LaTeX{} or HTML. \\

This package can be used from the \Rlogo~ prompt or from a user-friendly GUI.\\

This document provides an overview of the usage of the {\tt compareGroups} package.\\

To load the package using the \Rlogo~ prompt, enter:

\begin{Schunk}
\begin{Sinput}
> library(compareGroups)
\end{Sinput}
\end{Schunk}
Once the package is loaded, non-R users can follow the GUI instructions in Section \ref{gui}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Design: classes and methods} \label{Design}


The {\tt compareGroups} package has three functions:
\begin{itemize*}
\item {\tt compareGroups} creates an object of class {\tt compareGroups}. This object can be:
\begin{itemize*}
\item printed
\item summarized
\item plotted
\item updated
\end{itemize*}
\item {\tt createTable} creates an object of class {\tt createTable}. This object can be:
\begin{itemize*}
\item printed
\item summarized
\end{itemize*}
\item {\tt export2latex}, {\tt export2csv}, {\tt export2html} will export results to CSV, \LaTeX{} or HTML, respectively. 
\end{itemize*}

Figure \ref{fig:classes} shows the diagram of the package.

\begin{figure}[H]
\begin{center}
%\begin{changemargin1}
\includegraphics[width=0.8\textwidth]{./figures/classes.pdf}
\caption{Diagram of the {\tt compareGroups} package} \label{fig:classes}
%\end{changemargin1}
\end{center}
\end{figure}
\
\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Data used as example} \label{data}

To illustrate how this package works we sampled 85\% data from the participants in the PREDIMED study (\texttt{www.predimed.org}) \cite{PREDIMED}. PREDIMED is a multicenter trial in Spain, were randomly assigned participants who were at high cardiovascular risk, but with no cardiovascular disease at enrolment, to one of three diets: a Mediterranean diet supplemented with extra-virgin olive oil (MedDiet+VOO), a Mediterranean diet supplemented with mixed nuts (MedDiet+Nuts), or a control diet (advice to reduce dietary fat). Participants received quarterly individual and group educational sessions and, depending on group assignment, free provision of extra-virgin olive oil, mixed nuts, or small non-food gifts. The primary end point was the rate of major cardiovascular events (myocardial infarction, stroke, or death from cardiovascular causes.
\\

\noindent First of all, load PREDIMED data typing:
\begin{Schunk}
\begin{Sinput}
> data(predimed)
\end{Sinput}
\end{Schunk}


\vspace{0.3cm}
\noindent Variables and labels in this data frame are:

% latex table generated in R 3.0.1 by xtable 1.7-1 package
% Tue Jul 16 17:39:02 2013
{\small
\begin{longtable}{lll}
  \hline
Name & Label & Codes \\ 
  \hline
group & Intervention group & Control; MedDiet + Nuts; MedDiet + VOO \\ 
  sex & Sex & Male; Female \\ 
  age & Age &  \\ 
  smoke & Smoking & Never; Current; Former \\ 
  bmi & Body mass index &  \\ 
  waist & Waist circumference &  \\ 
  wth & Waist-to-height ratio &  \\ 
  htn & Hypertension & No; Yes \\ 
  diab & Type-2 diabetes & No; Yes \\ 
  hyperchol & Dyslipidemia & No; Yes \\ 
  famhist & Family history of premature CHD & No; Yes \\ 
  hormo & Hormone-replacement therapy & No; Yes \\ 
  p14 & MeDiet Adherence score &  \\ 
  toevent & follow-up to main event (years) &  \\ 
  event & AMI, stroke, or CV Death & No; Yes \\ 
   \hline
\hline
\end{longtable}
}\
\\


\noindent OBSERVATIONS:

\begin{enumerate}[1.]

\item It is important to note that {\tt compareGroups} is not aimed to perform quality control of the data. Other useful packages such as {\tt r2lh} \cite{r2lh} are available for this purpose. 

\item It is strongly recommended that the \textit{data.frame} contain only the variables to be analyzed; the ones not needed in the present analysis should be removed from the list.

\item The nature of variables to be analyzed should be known, or at least which variables are to be used as categorical. It is important to code categorical variables as factors and the order of their levels is meaningful in this package.

\item The function {\tt label} from the {\tt Hmisc} package could be used to label the variables properly. The tables of results will contain the variable labels (by default).

\end{enumerate}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Time-to-event variables} \label{timeto}

A variable of class {\tt Surv} must be created to deal with time-to-event variables (i.e., time to Cardiovascular event/censored in our example): 

\begin{Schunk}
\begin{Sinput}
> predimed$tmain <- with(predimed, Surv(toevent, event == 'Yes'))
> label(predimed$tmain) <- "AMI, stroke, or CV Death"
\end{Sinput}
\end{Schunk}
\
\\

Note that variables \textit{tmain} and %% \textit{tcv} 
are created as time-to-death and time-to-cardiovascular event, respectively, both taking into account censoring (i.e. they are of class Surv).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Using {\tt R} syntax} \label{section-using R syntax}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%
\subsection{\texttt{compareGroups}} \label{compareGroups}

This is the main function. It does all the calculus. It is needed to store results in an object. Later, applying the function {\tt createTable} (Section \ref{createTable}) to this object will create tables of the analysis results.

For example, to perform a univariate analysis with the \textit{predimed} data between \textit{group} (``response'' variable) and all other variables (``explanatory'' variables), this formula is required:

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ . , data=predimed)
\end{Sinput}
\end{Schunk}

%%%%
\subsubsection{\texttt{Selecting response variables}} \label{selevar}


If only a dot occurs on the right side of the ``$\thicksim$'' all variables in the data frame will be used.\\


To remove the variable \textit{toevent} and \textit{event} from the analysis:
\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ . -toevent - event, data=predimed)
\end{Sinput}
\end{Schunk}
\
\\

To select some explanatory variables (e.g., \textit{age}, \textit{sex}, and \textit{waist}) and store results in an object of class {\tt compareGroups}:

\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed)
> res
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value  method            selection
1 Age                         6324 0.003**  continuous normal ALL      
2 Sex                         6324 <0.001** categorical       ALL      
3 Smoking                     6324 0.444    categorical       ALL      
4 Waist circumference         6324 0.045**  continuous normal ALL      
5 Hormone-replacement therapy 5661 0.850    categorical       ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

\noindent Note: Although we have full data (n= 6324) for Age, Sex and Waist circumference, there are some missing data in Hormone-replacement therapy (probably male participants). \\

Diet groups have some differences in Smoking and Hormone-replacement therapy  although those don't reach statistical significance (p-value=0.714 and 0.859, repectively); although Age, Sex and Waist circumference are clearly different.\\

Age \& Waist circumference has been used as continuous and normal distributed. Sex, Smoking \& Hormone-replacement therapy as categorical. \\

No filters have been used (e.g., selecting only treated patients); therefore, the \textit{selection} column lists ``ALL'' (for all variables). \\

\
\\

%%%%%%%%%%%%%%%%
\subsubsection{Subsetting} \label{subsetting}

To perform the analysis in a subset of participants (e.g., ``female'' participants):

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+               subset = sex=='Female')
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value method            selection      
1 Age                         3645 0.056*  continuous normal sex == "Female"
2 Smoking                     3645 0.907   categorical       sex == "Female"
3 Waist circumference         3645 0.016** continuous normal sex == "Female"
4 Hormone-replacement therapy 3459 0.898   categorical       sex == "Female"
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

Note that only results for female participants are shown. \\

To subset specific variable/s (e.g., \textit{hormo} and \textit{waist}):


\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed, 
+               selec = list(hormo= sex=="Female", waist = waist>20 ))
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value  method            selection      
1 Age                         6324 0.003**  continuous normal ALL            
2 Sex                         6324 <0.001** categorical       ALL            
3 Smoking                     6324 0.444    categorical       ALL            
4 Waist circumference         6324 0.045**  continuous normal waist > 20     
5 Hormone-replacement therapy 3459 0.898    categorical       sex == "Female"
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

Combinations are also allowed, e.g.:


\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+               selec = list(waist= !is.na(hormo)), subset = sex=="Female")
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value method            selection                          
1 Age                         3645 0.056*  continuous normal sex == "Female"                    
2 Smoking                     3645 0.907   categorical       sex == "Female"                    
3 Waist circumference         3459 0.007** continuous normal (sex == "Female") & (!is.na(hormo))
4 Hormone-replacement therapy 3459 0.898   categorical       sex == "Female"                    
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}


A variable can appear twice in the formula, e.g.:

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + sex + bmi + bmi + waist + hormo, data=predimed, 
+               selec = list(bmi.1=!is.na(hormo)))
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value  method            selection    
1 Age                         6324 0.003**  continuous normal ALL          
2 Sex                         6324 <0.001** categorical       ALL          
3 Body mass index             6324 <0.001** continuous normal ALL          
4 Body mass index             5661 <0.001** continuous normal !is.na(hormo)
5 Waist circumference         6324 0.045**  continuous normal ALL          
6 Hormone-replacement therapy 5661 0.850    categorical       ALL          
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

In this case results for \textit{bmi} will be reported for all participants (n= 6324) and also for only those with no missing in Hormone-replacement therapy  (!is.na(hormo)). Note that ``bmi.1'' in the \textbf{selec} statement refers to the second time that \textit{bmi} appears in the formula.
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Methods for continuous variables} \label{method}


By default continuous variables are analyzed as normal-distributed. When a table is built (see {\tt createTable} function, Section \ref{createTable}), continuous variables will be described with mean and standard deviation. To change default options, e.g., ``waist'' used as non-normal distributed:

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+               method = c(waist=2))
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value method                selection
1 Age                         6324 0.003** continuous normal     ALL      
2 Smoking                     6324 0.444   categorical           ALL      
3 Waist circumference         6324 0.085*  continuous non-normal ALL      
4 Hormone-replacement therapy 5661 0.850   categorical           ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

Note that ``continuous non-normal'' is shown in the \textit{method} column for the variable Hormone-replacement therapy.\\

Possible values in  methods statement are:
\begin{itemize*}
\item 1: forces analysis as normal-distributed 
\item 2: forces analysis as continuous non-normal
\item 3: forces analysis as categorical
\item NA: performs a Shapiro-Wilks test to decide between normal or non-normal
\end{itemize*}

If the \textbf{method} for a variable is stated as \textbf{= NA}, then a Shapiro-Wilk test for normality is used to decide if the variable is normal or non-normal distributed. To change the significance threshold:

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+               method = c(waist=NA), alpha= 0.01)
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value method                selection
1 Age                         6324 0.003** continuous normal     ALL      
2 Smoking                     6324 0.444   categorical           ALL      
3 Waist circumference         6324 0.085*  continuous non-normal ALL      
4 Hormone-replacement therapy 5661 0.850   categorical           ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

According to Shapiro-Wilk test, stating the cutpoint at 0.01 level, Hormone-replacement therapy departed significantly from the normal distribution and therefore the method for this variable will be ``continuous non-normal''. \\
\
\\

All non factor variables are considered as continuous. Exception is made (by default) for those that have fewer than 5 different values. This threshold can be changed in the \textbf{min.dis} statement:

\begin{Schunk}
\begin{Sinput}
> cuts<-"lo:55=1; 56:60=2; 61:65=3; 66:70=4; 71:75=5; 76:80=6; 81:hi=7"
> predimed$age7gr<-car::recode(predimed$age, cuts)
> compareGroups(group ~ age7gr, data=predimed, method = c(age7gr=NA))
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var N    p.value method                selection
1 Age 6324 0.007** continuous non-normal ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\begin{Sinput}
> compareGroups(group ~ age7gr, data=predimed, method = c(age7gr=NA), min.dis=8)
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var N    p.value method      selection
1 Age 6324 0.009** categorical ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

To avoid errors the maximum categories for the response variable is set at 5 in this example (default value). If this variable has more than 5 different values, the function {\tt compareGroups} returns an error message. For example:

\begin{Verbatim**}
> compareGroups(age7gr ~ sex + bmi + waist , data=predimed)
\end{Verbatim**}

\begin{Verbatim*}
Error en compareGroups.default(X = X, y = y, include.label = include.label,  :
number of groups must be less or equal to 5
\end{Verbatim*}

Defaults setting can be changed with the \textbf{max.ylev} statement:

\begin{Schunk}
\begin{Sinput}
> compareGroups(age7gr ~ sex + bmi + waist, data=predimed, max.ylev=7)
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Age'---------


  var                 N    p.value  method            selection
1 Sex                 6324 <0.001** categorical       ALL      
2 Body mass index     6324 0.021**  continuous normal ALL      
3 Waist circumference 6324 0.034**  continuous normal ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

Similarly, by default there is a limit for the maximum number of levels for an explanatory variable. If this level is exceeded, the variable is removed from the analysis and a warning message is printed:

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ sex + age7gr, method= (age7gr=3), data=predimed, max.xlev=5)
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var N    p.value  method      selection
1 Sex 6324 <0.001** categorical ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}
\begin{Verbatim*}
Warning in compareGroups.default(X = X, y = y, include.label = include.label,  :
Variables 'age7gr' have been removed since some errors ocurred
\end{Verbatim*}
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Dressing up the output} \label{costum1}

Although the options described in this section correspond to {\tt compareGroups} function, results of changing/setting them won't be visible until the table is created with the {\tt createTable} function (explained later).\\
\
\\

\paragraph{include.label} By default the variable labels are shown in the output (if there is no label the name will be printed). Changing the statement include.label from ``= TRUE'' (default) to ``= FALSE'' will cause variable names to be printed instead.

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+               include.label= FALSE)
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'group'---------


  var   N    p.value method            selection
1 age   6324 0.003** continuous normal ALL      
2 smoke 6324 0.444   categorical       ALL      
3 waist 6324 0.045** continuous normal ALL      
4 hormo 5661 0.850   categorical       ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{Q1, Q3} When the method for a variable is stated as ``2'' (i.e., to be analyzed as continuous non-normal; see section \ref{method}), by default the median and quartiles 1 and 3 will be shown in the final results, after applying the function \texttt{createTable} (see Section \ref{createTable}).


\begin{Schunk}
\begin{Sinput}
> resu1<-compareGroups(group ~ age + waist, data=predimed, 
+                        method = c(waist=2))
> createTable(resu1)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

__________________________________________________________________________ 
                       Control     MedDiet + Nuts MedDiet + VOO  p.overall 
                        N=2042         N=2100         N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                  67.3 (6.28)    66.7 (6.02)    67.0 (6.21)     0.003   
Waist circumference 101 [94.0;108] 100 [93.0;107] 100 [93.0;107]   0.085   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\noindent Note: percentiles 25 and 75 are calculated for \textit{Waist circumference}.\\

To get instead percentile 2.5 and 97.5:
  
\begin{Schunk}
\begin{Sinput}
> resu2<-compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+                        method = c(waist=2), Q1=0.025, Q3=0.975)
> createTable(resu2)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

___________________________________________________________________________________ 
                                Control     MedDiet + Nuts MedDiet + VOO  p.overall 
                                 N=2042         N=2100         N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                           67.3 (6.28)    66.7 (6.02)    67.0 (6.21)     0.003   
Smoking:                                                                    0.444   
    Never                     1282 (62.8%)   1259 (60.0%)   1351 (61.9%)            
    Current                   270 (13.2%)    296 (14.1%)    292 (13.4%)             
    Former                    490 (24.0%)    545 (26.0%)    539 (24.7%)             
Waist circumference          101 [80.0;123] 100 [80.0;121] 100 [80.0;121]   0.085   
Hormone-replacement therapy:                                                0.850   
    No                        1811 (98.3%)   1835 (98.4%)   1918 (98.2%)            
    Yes                        31 (1.68%)     30 (1.61%)     36 (1.84%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\noindent Note: percentiles 2.5 and 97.5 are calculated for Follow-up. \\

To get minimum and maximum:
  
\
\\
\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smoke + waist + hormo, data=predimed, 
+                 method = c(waist=2), Q1=0, Q3=1)
\end{Sinput}
\end{Schunk}
\
\\

\paragraph{simplify} Sometimes a categorical variable has no individuals for a specific group. For example, \textit{smoker} has 3 levels. As an example and to illustrate this problem, we have created a new variable \textit{smk} with a new category (``Unknown''):
  
\begin{Schunk}
\begin{Sinput}
> predimed$smk<-predimed$smoke
> levels(predimed$smk)<- c("Never smoker", "Current or former < 1y", "Never or former >= 1y", "Unknown")
> label(predimed$smk)<-"Smoking 4 cat."
> cbind(table(predimed$smk))
\end{Sinput}
\begin{Soutput}
                       [,1]
Never smoker           3892
Current or former < 1y  858
Never or former >= 1y  1574
Unknown                   0
\end{Soutput}
\end{Schunk}

Note that this new category (``unknown'') has no individuals: 
 
\begin{Verbatim**}
> compareGroups(group ~ age + smk + waist + hormo, data=predimed)
\end{Verbatim**}

\begin{Verbatim*}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value method            selection
1 Age                         6324 0.001** continuous normal ALL      
2 Smoking 4 cat.              6324 0.714   categorical       ALL      
3 Waist circumference         6324 0.019** continuous normal ALL      
4 Hormone-replacement therapy 5650 0.859   categorical       ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 

Warning message:
In compare.i(X[, i], y = y, selec.i = selec[i], method.i = method[i],  :
  Some levels of 'smk' are removed since no observation in that/those levels

\end{Verbatim*}

Note that an ``Warning'' message is printed related to the problem with \textit{smk}.\\
\
\\

To avoid using empty categories, {\tt simplify} must be stated as {\tt TRUE} (Default value).

\begin{Schunk}
\begin{Sinput}
> compareGroups(group ~ age + smk, data=predimed, simplify=FALSE)
\end{Sinput}
\end{Schunk}

\begin{Verbatim*}
-------- Summary of results by groups of 'Intervention group'---------


  var            N    p.value method            selection
1 Age            6324 0.001** continuous normal ALL      
2 Smoking 4 cat. 6324 .       categorical       ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 

Warning messages:
1: In chisq.test(obj, simulate.p.value = TRUE) :
  cannot compute simulated p-value with zero marginals
2: In chisq.test(obj, simulate.p.value = TRUE) :
  Chi-squared approximation may be incorrect
\end{Verbatim*}
Nota that a warning message is shown and no p-values are calculated for Smoking.
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Summary} \label{summary}


Applying the \textbf{summary} function to an object of class \texttt{createTable} will obtain a more detailed output:
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + smoke + waist + hormo, method = c(waist=2),
+                    data=predimed)
> summary(res[c(1, 2, 4)])
\end{Sinput}
\begin{Soutput}
 --- Descriptives of each row-variable by groups of 'Intervention group' ---

------------------- 
row-variable: Age 

               N    mean     sd       p.overall p.trend  p.Control vs MedDiet + Nuts p.Control vs MedDiet + VOO
[ALL]          6324 67.0117  6.17499                                                                           
Control        2042 67.34231 6.27992  0.002666  0.101163 0.001672                    0.20596                   
MedDiet + Nuts 2100 66.6819  6.016395                                                                          
MedDiet + VOO  2182 67.01971 6.212578                                                                          
               p.MedDiet + Nuts vs MedDiet + VOO
[ALL]                                           
Control        0.172672                         
MedDiet + Nuts                                  
MedDiet + VOO                                   

------------------- 
row-variable: Sex 

               Male Female Male (row%) Female (row%) p.overall p.trend  p.Control vs MedDiet + Nuts
[ALL]          2679 3645   42.36243    57.63757                                                    
Control        812  1230   39.76494    60.23506      8.1e-05   0.388386 0.000133                   
MedDiet + Nuts 968  1132   46.09524    53.90476                                                    
MedDiet + VOO  899  1283   41.20073    58.79927                                                    
               p.Control vs MedDiet + VOO p.MedDiet + Nuts vs MedDiet + VOO
[ALL]                                                                      
Control        0.358324                   0.002076                         
MedDiet + Nuts                                                             
MedDiet + VOO                                                              

------------------- 
row-variable: Waist circumference 

               N    med Q1 Q3  p.overall p.trend  p.Control vs MedDiet + Nuts p.Control vs MedDiet + VOO
[ALL]          6324 100 93 107                                                                          
Control        2042 101 94 108 0.084601  0.039557 0.125792                    0.110639                  
MedDiet + Nuts 2100 100 93 107                                                                          
MedDiet + VOO  2182 100 93 107                                                                          
               p.MedDiet + Nuts vs MedDiet + VOO
[ALL]                                           
Control        0.743479                         
MedDiet + Nuts                                  
MedDiet + VOO                                   
\end{Soutput}
\end{Schunk}

Note that because only variables 1, 3 \& 4 are selected, only results for Age, Sex \& Waist circumference are shown. Age is summarized by the mean and the standard deviation, Sex by frequencies and percentage, and Waist circumference (method =2) by the median and quartiles.
\
\\


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Plotting} \label{plotting}

Variables can be plotted to see their distribution. Plots differ according to whether the variable is continuous or categorical. Plots can be seen on-screen or saved as PDF.

\begin{Schunk}
\begin{Sinput}
> plot(res[c(1,2)], file="./figures/univar/")
\end{Sinput}
\end{Schunk}

\begin{flushleft}
\begin{figure}[!h]
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/univar/age.pdf}
\caption{Plot of Age}
\end{minipage}
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/univar/sex.pdf}
\caption{Plot of Sex}
\end{minipage}
\end{figure}
\end{flushleft}

Plots also can be done according to grouping variable. In this case only a boxplot is shown for continuous variables:
  
\begin{Schunk}
\begin{Sinput}
> plot(res[c(1,2)], bivar=TRUE, file="./figures/bivar/")
\end{Sinput}
\end{Schunk}

\begin{flushleft}
\begin{figure}[!h]
\begin{minipage}{9cm}
\includegraphics[width=0.9\textwidth]{./figures/bivar/age.pdf}
\caption{Plot of Age}
\end{minipage}
\begin{minipage}{9cm}
\includegraphics[width=0.9\textwidth]{./figures/bivar/sex.pdf}
\caption{Plot of Sex}
\end{minipage}
\end{figure}
\end{flushleft}
\
\\


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Updating} \label{updating}

The object from {\tt compareGroups} can later be updated. For example:
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed)
> res
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                         N    p.value  method            selection
1 Age                         6324 0.003**  continuous normal ALL      
2 Sex                         6324 <0.001** categorical       ALL      
3 Smoking                     6324 0.444    categorical       ALL      
4 Waist circumference         6324 0.045**  continuous normal ALL      
5 Hormone-replacement therapy 5661 0.850    categorical       ALL      
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

The object \textit{res} is updated using:
  
\begin{Schunk}
\begin{Sinput}
> res<-update(res, . ~. - sex +  bmi + toevent, subset = sex=='Female', 
+               method = c(waist=2, tovent=2), selec = list(bmi=!is.na(hormo)))
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> res
\end{Sinput}
\begin{Soutput}
-------- Summary of results by groups of 'Intervention group'---------


  var                             N    p.value  method                selection                          
1 Age                             3645 0.056*   continuous normal     sex == "Female"                    
2 Smoking                         3645 0.907    categorical           sex == "Female"                    
3 Waist circumference             3645 0.037**  continuous non-normal sex == "Female"                    
4 Hormone-replacement therapy     3459 0.898    categorical           sex == "Female"                    
5 Body mass index                 3459 0.002**  continuous normal     (sex == "Female") & (!is.na(hormo))
6 follow-up to main event (years) 3645 <0.001** continuous normal     sex == "Female"                    
-----
Signif. codes:  0 '**' 0.05 '*' 0.1 ' ' 1 
\end{Soutput}
\end{Schunk}

Note that ``Sex'' is removed as an explanatory variable but used as a filter, subsetting only ``Female'' participants. Variable ``Waist circumference'' has been changed to ``continuous non-normal''. Two new variables have been added: Body mass index and Follow-up (stated continuous non-normal). For Body mass index is stated to show only data of participants with non-missing values in Hormone-replacement therapy.
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Odds Ratios \& Hazard Ratios} \label{orhr}

When the response variable is binary, the Odds Ratio (OR) can be printed in the final table. If the response variable is time-to-event (see Section \ref{timeto}), the Hazard Ratio (HR) can be printed instead.
\
\\

\paragraph{ref} This statement can be used to change the reference category:
  
\begin{Schunk}
\begin{Sinput}
> res1<-compareGroups(htn ~ age + sex + bmi + smoke, data=predimed, ref=1)
> createTable(res1, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

___________________________________________________________________________ 
                    No          Yes             OR        p.ratio p.overall 
                  N=1089       N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15)  1.04 [1.03;1.05] <0.001   <0.001   
Sex:                                                               <0.001   
    Male        595 (54.6%) 2084 (39.8%)       Ref.        Ref.             
    Female      494 (45.4%) 3151 (60.2%) 1.82 [1.60;2.08]  0.000            
Body mass index 28.9 (3.69) 30.2 (3.80)  1.10 [1.08;1.12] <0.001   <0.001   
Smoking:                                                           <0.001   
    Never       536 (49.2%) 3356 (64.1%)       Ref.        Ref.             
    Current     233 (21.4%) 625 (11.9%)  0.43 [0.36;0.51]  0.000            
    Former      320 (29.4%) 1254 (24.0%) 0.63 [0.54;0.73] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that for categorical response variables the reference category is the first one in the statement:
  
\begin{Schunk}
\begin{Sinput}
> res2<-compareGroups(htn ~ age + sex + bmi + smoke, data=predimed, 
+                     ref=c(smoke=1, sex=2))
> createTable(res2, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

___________________________________________________________________________ 
                    No          Yes             OR        p.ratio p.overall 
                  N=1089       N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15)  1.04 [1.03;1.05] <0.001   <0.001   
Sex:                                                               <0.001   
    Male        595 (54.6%) 2084 (39.8%) 0.55 [0.48;0.63]  0.000            
    Female      494 (45.4%) 3151 (60.2%)       Ref.        Ref.             
Body mass index 28.9 (3.69) 30.2 (3.80)  1.10 [1.08;1.12] <0.001   <0.001   
Smoking:                                                           <0.001   
    Never       536 (49.2%) 3356 (64.1%)       Ref.        Ref.             
    Current     233 (21.4%) 625 (11.9%)  0.43 [0.36;0.51]  0.000            
    Former      320 (29.4%) 1254 (24.0%) 0.63 [0.54;0.73] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that the reference category for Smoking status is the first and for Sex the second.

\
\\

\paragraph{ref.no} Similarly to the ``ref'' statement, {\tt ref.no} is used to state ``no'' as the reference category for all variables with this category:
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(htn ~ age + sex + bmi + hormo + hyperchol, data=predimed, 
+                    ref.no='NO')
> createTable(res, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

________________________________________________________________________________________ 
                                 No          Yes             OR        p.ratio p.overall 
                               N=1089       N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          65.9 (6.19) 67.2 (6.15)  1.04 [1.03;1.05] <0.001   <0.001   
Sex:                                                                            <0.001   
    Male                     595 (54.6%) 2084 (39.8%)       Ref.        Ref.             
    Female                   494 (45.4%) 3151 (60.2%) 1.82 [1.60;2.08]  0.000            
Body mass index              28.9 (3.69) 30.2 (3.80)  1.10 [1.08;1.12] <0.001   <0.001   
Hormone-replacement therapy:                                                     0.856   
    No                       928 (98.4%) 4636 (98.3%)       Ref.        Ref.             
    Yes                      15 (1.59%)   82 (1.74%)  1.08 [0.64;1.97]  0.773            
Dyslipidemia:                                                                   <0.001   
    No                       409 (37.6%) 1337 (25.5%)       Ref.        Ref.             
    Yes                      680 (62.4%) 3898 (74.5%) 1.75 [1.53;2.01] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note: 'no', 'No' or 'NO' will produce the same results; the coding is not case sensitive.
\
\\

\paragraph{fact.ratio} By default OR or HR for continuous variables are calculated for each unit increase. It can be changed by the {\tt fact.or} statement:
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(htn ~ age + bmi, data=predimed)
> createTable(res, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

__________________________________________________________________________ 
                    No          Yes            OR        p.ratio p.overall 
                  N=1089      N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15) 1.04 [1.03;1.05] <0.001   <0.001   
Body mass index 28.9 (3.69) 30.2 (3.80) 1.10 [1.08;1.12] <0.001   <0.001   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Here the OR is for the increase of one unit for Age and Systolic blood pressure.

\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(htn ~ age + bmi, data=predimed, 
+                    fact.ratio= c(age=10, bmi=2))
> createTable(res, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

__________________________________________________________________________ 
                    No          Yes            OR        p.ratio p.overall 
                  N=1089      N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15) 1.43 [1.28;1.59] <0.001   <0.001   
Body mass index 28.9 (3.69) 30.2 (3.80) 1.22 [1.17;1.26] <0.001   <0.001   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Here the OR is for the increase of 10 years for Age and 2 units for Body mass index.
\
\\

\paragraph{ref.y} By default when OR or HR are calculated, the reference category for the response variable is the first. The reference category could be changed using the {\tt ref.y} statement:  
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(htn ~ age + sex + bmi + hyperchol, data=predimed)
> createTable(res, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

___________________________________________________________________________ 
                    No          Yes             OR        p.ratio p.overall 
                  N=1089       N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15)  1.04 [1.03;1.05] <0.001   <0.001   
Sex:                                                               <0.001   
    Male        595 (54.6%) 2084 (39.8%)       Ref.        Ref.             
    Female      494 (45.4%) 3151 (60.2%) 1.82 [1.60;2.08]  0.000            
Body mass index 28.9 (3.69) 30.2 (3.80)  1.10 [1.08;1.12] <0.001   <0.001   
Dyslipidemia:                                                      <0.001   
    No          409 (37.6%) 1337 (25.5%)       Ref.        Ref.             
    Yes         680 (62.4%) 3898 (74.5%) 1.75 [1.53;2.01] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\noindent Note: This output shows the OR of having hypertension. Therefore, 'Non-hypertension' is the reference category.


\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(htn ~ age + sex + bmi + hyperchol, data=predimed, ref.y=2)
> createTable(res, show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Hypertension'---------

___________________________________________________________________________ 
                    No          Yes             OR        p.ratio p.overall 
                  N=1089       N=5235                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             65.9 (6.19) 67.2 (6.15)  0.96 [0.98;0.95] <0.001   <0.001   
Sex:                                                               <0.001   
    Male        595 (54.6%) 2084 (39.8%)       Ref.        Ref.             
    Female      494 (45.4%) 3151 (60.2%) 0.55 [0.48;0.63]  0.000            
Body mass index 28.9 (3.69) 30.2 (3.80)  0.91 [0.92;0.89] <0.001   <0.001   
Dyslipidemia:                                                      <0.001   
    No          409 (37.6%) 1337 (25.5%)       Ref.        Ref.             
    Yes         680 (62.4%) 3898 (74.5%) 0.57 [0.50;0.65] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

%%% 
\noindent Note: This output shows the OR of having No hypertension.
\
\\

Note: This output shows the OR of having No hypertension, and 'Hypertension' is now the reference category.\\
\
\\

When the response variable is of class \texttt{Surv}, the bivariate {\tt plot} function returns a Kaplan-Meier figure if the explanatory variable is categorical. For continuous variables the function returns a line for each individual, ending with a circle for censored and with a plus sign for uncensored.

\begin{Schunk}
\begin{Sinput}
> plot(compareGroups(tmain ~ sex, data=predimed), bivar=TRUE, file="./figures/bivar/")
> plot(compareGroups(tmain ~ age, data=predimed), bivar=TRUE, file="./figures/bivar/")
\end{Sinput}
\end{Schunk}

\begin{flushleft}
\begin{figure}[!h]
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/bivar/age.pdf}
\caption{Categorical}
\end{minipage}
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/bivar/sex.pdf}
\caption{Continuous}
\end{minipage}
\end{figure}
\end{flushleft}

\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Time-to-event explanatory variables} \label{timevar}

When a variable of class \texttt{Surv} (see Section \ref{timeto}) is used as
explanatory it will be described with the probability of event, 
computed by Kaplan-Meier, up to a stated time.
\
\\

\paragraph{timemax} By default probability is calculated at the median of the follow-up period. {\tt timemax} option allows us to change at what time probability is calculated.

\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(sex ~  age + tmain, timemax=c(tmain=3),
+                    data=predimed)
> res
\end{Sinput}
\end{Schunk}

Note that \textit{tmain} is calculated at 3 years (see section \ref{timeto}).\\
\
\\

The {\tt plot} function applied to a variable of class \texttt{Surv} returns a Kaplan-Meier figure. The figure can be stratified by the grouping variable.

\begin{Schunk}
\begin{Sinput}
> plot(res[2], file="./figures/univar/")
> plot(res[2], bivar=TRUE, file="./figures/bivar/")
\end{Sinput}
\end{Schunk}

\begin{flushleft}
\begin{figure}[!h]
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/univar/tmain.pdf}
\caption{Univariate}
\end{minipage}
\begin{minipage}{9cm}
\includegraphics[width=0.8\textwidth]{./figures/bivar/tmain.pdf}
\caption{Stratified by \textit{year}}
\end{minipage}
\end{figure}
\end{flushleft}
\
\\

%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{createTable}} \label{createTable}

\texttt{createTable} function, applied to an object of \texttt{compareGroups} class, returns tables with descriptives that can be displayed on-screen or exported to CSV, \LaTeX{} or HTML.



\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed, 
+               selec = list(hormo=sex=="Female"))
> restab<-createTable(res)
\end{Sinput}
\end{Schunk}

Two tables are created with the \texttt{createTable} function: one with the descriptives and the other with the available data. The {\tt print} command print applied to an object of class {\tt createTable} returns one or both tables:
  
\begin{Schunk}
\begin{Sinput}
> print(restab,which.table='descr')
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

________________________________________________________________________________ 
                               Control    MedDiet + Nuts MedDiet + VOO p.overall 
                                N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                    <0.001   
    Male                     812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female                   1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Smoking:                                                                 0.444   
    Never                    1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
    Current                  270 (13.2%)   296 (14.1%)    292 (13.4%)            
    Former                   490 (24.0%)   545 (26.0%)    539 (24.7%)            
Waist circumference           101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                             0.898   
    No                       1143 (97.4%)  1036 (97.2%)  1183 (97.0%)            
    Yes                       31 (2.64%)    30 (2.81%)    36 (2.95%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that the option ``descr'' returns descriptives.

\begin{Schunk}
\begin{Sinput}
> print(restab,which.table='avail')
\end{Sinput}
\begin{Soutput}
---Available data----

________________________________________________________________________________________________________ 
                            [ALL] Control MedDiet + Nuts MedDiet + VOO      method           select      
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                         6324   2042        2100          2182      continuous-normal       ALL       
Sex                         6324   2042        2100          2182         categorical          ALL       
Smoking                     6324   2042        2100          2182         categorical          ALL       
Waist circumference         6324   2042        2100          2182      continuous-normal       ALL       
Hormone-replacement therapy 3459   1174        1066          1219         categorical    sex == "Female" 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that the option ``avail'' returns the available data, as well as methods and selections.
\
\\

By default only the descriptives table is shown. Stating ``both'' in {\tt which.table} options returns both tables.
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Dressing up tables} \label{costum2}

\paragraph{hide} If the explanatory variable is dichotomous, one of the categories often is hidden in the results displayed (i.e., if 42.4\% are male, obviously 57.6\% are female). To hide some category, e.g., Male:
\begin{Schunk}
\begin{Sinput}
> update(restab, hide = c(sex="Male"))
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

________________________________________________________________________________ 
                               Control    MedDiet + Nuts MedDiet + VOO p.overall 
                                N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex: Female                  1230 (60.2%)  1132 (53.9%)  1283 (58.8%)   <0.001   
Smoking:                                                                 0.444   
    Never                    1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
    Current                  270 (13.2%)   296 (14.1%)    292 (13.4%)            
    Former                   490 (24.0%)   545 (26.0%)    539 (24.7%)            
Waist circumference           101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                             0.898   
    No                       1143 (97.4%)  1036 (97.2%)  1183 (97.0%)            
    Yes                       31 (2.64%)    30 (2.81%)    36 (2.95%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that the percentage of males is hidden.
\
\\

\paragraph{hide.no} Similarly, as explained above, if the category ``no'' is to be hidden for all variables:
  
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + htn + diab, data=predimed)
> createTable(res, hide.no='no', hide = c(sex="Male"))
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

___________________________________________________________________ 
                  Control    MedDiet + Nuts MedDiet + VOO p.overall 
                   N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex: Female     1230 (60.2%)  1132 (53.9%)  1283 (58.8%)   <0.001   
Hypertension    1711 (83.8%)  1738 (82.8%)  1786 (81.9%)    0.249   
Type-2 diabetes 970 (47.5%)   950 (45.2%)   1082 (49.6%)    0.017   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note: 'no', 'No' or 'NO' will produce the same results; the coding is not case sensitive.
\
\\

\paragraph{digits} The number of digits that appear in the results can be changed, e.g:
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, digits= c(age=2, sex = 3))
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_______________________________________________________________________ 
                    Control     MedDiet + Nuts MedDiet + VOO  p.overall 
                     N=2042         N=2100         N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age               67.34 (6.28)   66.68 (6.02)   67.02 (6.21)    0.003   
Sex:                                                           <0.001   
    Male         812 (39.765%)  968 (46.095%)  899 (41.201%)            
    Female       1230 (60.235%) 1132 (53.905%) 1283 (58.799%)           
Hypertension:                                                   0.249   
    No            331 (16.2%)    362 (17.2%)    396 (18.1%)             
    Yes           1711 (83.8%)   1738 (82.8%)   1786 (81.9%)            
Type-2 diabetes:                                                0.017   
    No            1072 (52.5%)   1150 (54.8%)   1100 (50.4%)            
    Yes           970 (47.5%)    950 (45.2%)    1082 (49.6%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that mean and standard deviation has two decimal places for age, while percentage in sex has been set to three decimal places.
\
\\

\paragraph{type} By default categorical variables are summarized by frequencies and percentages. This can be changed by the {\tt type} command:
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, type=1)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

___________________________________________________________________ 
                   Control   MedDiet + Nuts MedDiet + VOO p.overall 
                   N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)  66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                       <0.001   
    Male            39.8%        46.1%          41.2%               
    Female          60.2%        53.9%          58.8%               
Hypertension:                                               0.249   
    No              16.2%        17.2%          18.1%               
    Yes             83.8%        82.8%          81.9%               
Type-2 diabetes:                                            0.017   
    No              52.5%        54.8%          50.4%               
    Yes             47.5%        45.2%          49.6%               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that only percentages are displayed.

\begin{Schunk}
\begin{Sinput}
> createTable(res, type=3)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

___________________________________________________________________ 
                   Control   MedDiet + Nuts MedDiet + VOO p.overall 
                   N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)  66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                       <0.001   
    Male             812          968            899                
    Female          1230          1132          1283                
Hypertension:                                               0.249   
    No               331          362            396                
    Yes             1711          1738          1786                
Type-2 diabetes:                                            0.017   
    No              1072          1150          1100                
    Yes              970          950           1082                
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that only frequencies are displayed.\\
\\ 

Values 2 or ``NA'' return the same results, i.e., the default option.
\
\\

\paragraph{show.n} If option \texttt{show.n} is set to ``TRUE'' a column with available data for each variable appears in the results:
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.n=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_________________________________________________________________________ 
                   Control    MedDiet + Nuts MedDiet + VOO p.overall  N   
                    N=2042        N=2100        N=2182                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   6324 
Sex:                                                        <0.001   6324 
    Male         812 (39.8%)   968 (46.1%)    899 (41.2%)                 
    Female       1230 (60.2%)  1132 (53.9%)  1283 (58.8%)                 
Hypertension:                                                0.249   6324 
    No           331 (16.2%)   362 (17.2%)    396 (18.1%)                 
    Yes          1711 (83.8%)  1738 (82.8%)  1786 (81.9%)                 
Type-2 diabetes:                                             0.017   6324 
    No           1072 (52.5%)  1150 (54.8%)  1100 (50.4%)                 
    Yes          970 (47.5%)   950 (45.2%)   1082 (49.6%)                 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{show.descr} If option \texttt{show.descr} is set to ``FALSE'' only p-values are displayed:
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.descr=FALSE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

__________________________ 
                 p.overall 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                0.003   
Sex:                       
    Male          <0.001   
    Female                 
Hypertension:              
    No             0.249   
    Yes                    
Type-2 diabetes:           
    No             0.017   
    Yes                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{show.all} If \texttt{show.all} option is set to ``TRUE'' a column is displayed with descriptives for all data:
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.all=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_________________________________________________________________________________ 
                    [ALL]       Control    MedDiet + Nuts MedDiet + VOO p.overall 
                    N=6324       N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.0 (6.17)  67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                     <0.001   
    Male         2679 (42.4%) 812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female       3645 (57.6%) 1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Hypertension:                                                             0.249   
    No           1089 (17.2%) 331 (16.2%)   362 (17.2%)    396 (18.1%)            
    Yes          5235 (82.8%) 1711 (83.8%)  1738 (82.8%)  1786 (81.9%)            
Type-2 diabetes:                                                          0.017   
    No           3322 (52.5%) 1072 (52.5%)  1150 (54.8%)  1100 (50.4%)            
    Yes          3002 (47.5%) 970 (47.5%)   950 (45.2%)   1082 (49.6%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{show.p.overall} If option \texttt{show.p.overall} is set to ``FALSE'' p-values are omitted from the table:
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.p.overall=FALSE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

__________________________________________________________ 
                   Control    MedDiet + Nuts MedDiet + VOO 
                    N=2042        N=2100        N=2182     
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)   66.7 (6.02)    67.0 (6.21)  
Sex:                                                       
    Male         812 (39.8%)   968 (46.1%)    899 (41.2%)  
    Female       1230 (60.2%)  1132 (53.9%)  1283 (58.8%)  
Hypertension:                                              
    No           331 (16.2%)   362 (17.2%)    396 (18.1%)  
    Yes          1711 (83.8%)  1738 (82.8%)  1786 (81.9%)  
Type-2 diabetes:                                           
    No           1072 (52.5%)  1150 (54.8%)  1100 (50.4%)  
    Yes          970 (47.5%)   950 (45.2%)   1082 (49.6%)  
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{show.p.trend} If the response variable has more than two categories a p-value for trend can be calculated. Results are displayed if the \texttt{show.p.trend} option is set to ``TRUE'':
  
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.p.trend=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

____________________________________________________________________________ 
                   Control    MedDiet + Nuts MedDiet + VOO p.overall p.trend 
                    N=2042        N=2100        N=2182                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003    0.101  
Sex:                                                        <0.001    0.388  
    Male         812 (39.8%)   968 (46.1%)    899 (41.2%)                    
    Female       1230 (60.2%)  1132 (53.9%)  1283 (58.8%)                    
Hypertension:                                                0.249    0.096  
    No           331 (16.2%)   362 (17.2%)    396 (18.1%)                    
    Yes          1711 (83.8%)  1738 (82.8%)  1786 (81.9%)                    
Type-2 diabetes:                                             0.017    0.160  
    No           1072 (52.5%)  1150 (54.8%)  1100 (50.4%)                    
    Yes          970 (47.5%)   950 (45.2%)   1082 (49.6%)                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\noindent Note: The p-value for trend is computed from the Pearson test when row-variable is normal and from the Spearman test when it is continuous non-normal. If row-variable is of class {\tt Surv}, the test score is computed from a Cox model where the grouping variable is introduced as an integer variable predictor. If the row-variable is categorical, the p-value for trend is computed as $
  1-pchisq(cor(as.integer(x),as.integer(y))^2*(length(x)-1),1)$
  \
\\

\paragraph{show.p.mul} For a response variable with more than two categories a pairwise comparison of p-values, corrected for multiple comparisons, can be calculated. Results are displayed if the \texttt{show.p.mul} option is set to ``TRUE'':
\begin{landscape}  
\begin{Schunk}
\begin{Sinput}
> createTable(res, show.p.mul=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_____________________________________________________________________________________________________________________________________________________________ 
                   Control    MedDiet + Nuts MedDiet + VOO p.overall p.Control vs MedDiet + Nuts p.Control vs MedDiet + VOO p.MedDiet + Nuts vs MedDiet + VOO 
                    N=2042        N=2100        N=2182                                                                                                        
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003              0.002                      0.206                          0.173               
Sex:                                                        <0.001             <0.001                      0.358                          0.002               
    Male         812 (39.8%)   968 (46.1%)    899 (41.2%)                                                                                                     
    Female       1230 (60.2%)  1132 (53.9%)  1283 (58.8%)                                                                                                     
Hypertension:                                                0.249              0.459                      0.311                          0.459               
    No           331 (16.2%)   362 (17.2%)    396 (18.1%)                                                                                                     
    Yes          1711 (83.8%)  1738 (82.8%)  1786 (81.9%)                                                                                                     
Type-2 diabetes:                                             0.017              0.185                      0.185                          0.014               
    No           1072 (52.5%)  1150 (54.8%)  1100 (50.4%)                                                                                                     
    Yes          970 (47.5%)   950 (45.2%)   1082 (49.6%)                                                                                                     
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\noindent Note: Tukey method is used when explanatory variable is normal-distributed and Benjamini \& Hochberg \cite{BH} method otherwise.
\end{landscape}
\paragraph{show.ratio} If response variable is dichotomous or has been defined as class {\tt survival} (see Section \ref{timeto}), Odds Ratios and Hazard Ratios can be displayed in the results by stating ``TRUE'' at the show.ratio option:
  
\begin{Schunk}
\begin{Sinput}
> createTable(update(res, subset= group!="Control diet"), show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

____________________________________________________________________ 
                   Control    MedDiet + Nuts MedDiet + VOO p.overall 
                    N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age              67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                        <0.001   
    Male         812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female       1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Hypertension:                                                0.249   
    No           331 (16.2%)   362 (17.2%)    396 (18.1%)            
    Yes          1711 (83.8%)  1738 (82.8%)  1786 (81.9%)            
Type-2 diabetes:                                             0.017   
    No           1072 (52.5%)  1150 (54.8%)  1100 (50.4%)            
    Yes          970 (47.5%)   950 (45.2%)   1082 (49.6%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that category ``Control diet'' of the response variable has been omitted in order to have only two categories (i.e., a dichotomous variable). No Odds Ratios would be calculated if response variable has more than two categories.

\begin{Schunk}
\begin{Sinput}
> createTable(compareGroups(tmain ~  group + age + sex, data=predimed), 
+             show.ratio=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'AMI, stroke, or CV Death'---------

_______________________________________________________________________________ 
                      No event      Event           HR        p.ratio p.overall 
                       N=6072       N=252                                       
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Intervention group:                                                     0.011   
    Control         1945 (32.0%) 97 (38.5%)        Ref.        Ref.             
    MedDiet + Nuts  2030 (33.4%) 70 (27.8%)  0.66 [0.48;0.89]  0.008            
    MedDiet + VOO   2097 (34.5%) 85 (33.7%)  0.70 [0.53;0.94]  0.018            
Age                 66.9 (6.14)  69.4 (6.65) 1.06 [1.04;1.09] <0.001   <0.001   
Sex:                                                                   <0.001   
    Male            2528 (41.6%) 151 (59.9%)       Ref.        Ref.             
    Female          3544 (58.4%) 101 (40.1%) 0.49 [0.38;0.63] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that when response variable is of class {\tt Surv}, Hazard Ratios are calculated instead of Odds Ratios.
\
\\

\paragraph{digits.ratio} The number of decimal places for Odds/Hazard ratios can be changed by the \texttt{digits.ratio} option:
  
\begin{Schunk}
\begin{Sinput}
> createTable(compareGroups(tmain ~  group + age + sex, data=predimed), 
+             show.ratio=TRUE, digits.ratio= 3)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'AMI, stroke, or CV Death'---------

__________________________________________________________________________________ 
                      No event      Event            HR          p.ratio p.overall 
                       N=6072       N=252                                          
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Intervention group:                                                        0.011   
    Control         1945 (32.0%) 97 (38.5%)         Ref.          Ref.             
    MedDiet + Nuts  2030 (33.4%) 70 (27.8%)  0.658 [0.484;0.894]  0.008            
    MedDiet + VOO   2097 (34.5%) 85 (33.7%)  0.703 [0.525;0.941]  0.018            
Age                 66.9 (6.14)  69.4 (6.65) 1.065 [1.043;1.086] <0.001   <0.001   
Sex:                                                                      <0.001   
    Male            2528 (41.6%) 151 (59.9%)        Ref.          Ref.             
    Female          3544 (58.4%) 101 (40.1%) 0.488 [0.379;0.628] <0.001            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Combining tables by row} \label{combirow}  

Tables made with the same response variable can be combined by row:
  
\begin{Schunk}
\begin{Sinput}
> restab1 <- createTable(compareGroups(group ~ age + sex, data=predimed))
> restab2 <- createTable(compareGroups(group ~ bmi + smoke, data=predimed))
> rbind("Non-modifiable risk factors"=restab1, "Modifiable risk factors"=restab2)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_______________________________________________________________________ 
                      Control    MedDiet + Nuts MedDiet + VOO p.overall 
                       N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Non-modifiable risk factors:
    Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
    Sex:                                                       <0.001   
        Male        812 (39.8%)   968 (46.1%)    899 (41.2%)            
        Female      1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Modifiable risk factors:
    Body mass index 30.3 (3.96)   29.7 (3.77)    29.9 (3.71)   <0.001   
    Smoking:                                                    0.444   
        Never       1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
        Current     270 (13.2%)   296 (14.1%)    292 (13.4%)            
        Former      490 (24.0%)   545 (26.0%)    539 (24.7%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note how variables are grouped under ``Non-modifiable'' and ``Modifiable'' risk factors because of an epigraph defined in the {\tt rbind} command in the example.\\
\
\\

The resulting object is of class {\tt rbind.createTable}, which can be subset but not updated. It inherits the class 'createTable'. Therefore, columns and other arguments from the {\tt createTable} function cannot be modified:\\
\
\\

To select only Age and Smoking:
  
\begin{Schunk}
\begin{Sinput}
> rbind("Non-modifiable"=restab1,"Modifiable"=restab2)[c(1,4)]
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

___________________________________________________________________ 
                  Control    MedDiet + Nuts MedDiet + VOO p.overall 
                   N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Non-modifiable:
    Age         67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Modifiable:
    Smoking:                                                0.444   
        Never   1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
        Current 270 (13.2%)   296 (14.1%)    292 (13.4%)            
        Former  490 (24.0%)   545 (26.0%)    539 (24.7%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

To change the order:
  
\begin{Schunk}
\begin{Sinput}
> rbind("Modifiable"=restab1,"Non-modifiable"=restab2)[c(4,3,2,1)]
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_______________________________________________________________________ 
                      Control    MedDiet + Nuts MedDiet + VOO p.overall 
                       N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Non-modifiable:
    Smoking:                                                    0.444   
        Never       1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
        Current     270 (13.2%)   296 (14.1%)    292 (13.4%)            
        Former      490 (24.0%)   545 (26.0%)    539 (24.7%)            
    Body mass index 30.3 (3.96)   29.7 (3.77)    29.9 (3.71)   <0.001   
Modifiable:
    Sex:                                                       <0.001   
        Male        812 (39.8%)   968 (46.1%)    899 (41.2%)            
        Female      1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
    Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Combining tables by column} \label{combicol}  

Columns from tables built with the same explanatory and response variables but done with a different subset (i.e. ALL, Male and Female) can be combined:
\begin{landscape}
\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age +  smoke + bmi + htn , data=predimed)
> alltab <- createTable(res,  show.p.overall = FALSE)
> femaletab <- createTable(update(res,subset=sex=='Female'), show.p.overall = FALSE)
> maletab <- createTable(update(res,subset=sex=='Male'), show.p.overall = FALSE)
> cbind("ALL"=alltab,"FEMALE"=femaletab,"MALE"=maletab)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table ---------

______________________________________________________________________________________________________________________________________________
                                   ALL                                      FEMALE                                      MALE                  
                _________________________________________  _________________________________________  ________________________________________
                  Control    MedDiet + Nuts MedDiet + VOO    Control    MedDiet + Nuts MedDiet + VOO    Control   MedDiet + Nuts MedDiet + VOO 
                   N=2042        N=2100        N=2182         N=1230        N=1132        N=1283         N=812        N=968          N=899     
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)   68.0 (5.96)   67.4 (5.57)    67.7 (5.84)   66.4 (6.62)  65.8 (6.40)    66.1 (6.61)  
Smoking:                                                                                                                                       
    Never       1282 (62.8%)  1259 (60.0%)  1351 (61.9%)   1077 (87.6%)  993 (87.7%)   1115 (86.9%)   205 (25.2%)  266 (27.5%)    236 (26.3%)  
    Current     270 (13.2%)   296 (14.1%)    292 (13.4%)    66 (5.37%)    54 (4.77%)    71 (5.53%)    204 (25.1%)  242 (25.0%)    221 (24.6%)  
    Former      490 (24.0%)   545 (26.0%)    539 (24.7%)    87 (7.07%)    85 (7.51%)    97 (7.56%)    403 (49.6%)  460 (47.5%)    442 (49.2%)  
Body mass index 30.3 (3.96)   29.7 (3.77)    29.9 (3.71)   30.8 (4.20)   30.2 (4.08)    30.4 (3.91)   29.6 (3.45)  29.1 (3.28)    29.2 (3.28)  
Hypertension:                                                                                                                                  
    No          331 (16.2%)   362 (17.2%)    396 (18.1%)   168 (13.7%)   147 (13.0%)    179 (14.0%)   163 (20.1%)  215 (22.2%)    217 (24.1%)  
    Yes         1711 (83.8%)  1738 (82.8%)  1786 (81.9%)   1062 (86.3%)  985 (87.0%)   1104 (86.0%)   649 (79.9%)  753 (77.8%)    682 (75.9%)  
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
\end{Soutput}
\end{Schunk}

With the argument \textit{caption} set to {\tt NULL} no name is displayed for columns. \\

\begin{Schunk}
\begin{Sinput}
> cbind(alltab,femaletab,maletab,caption=NULL)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table ---------

______________________________________________________________________________________________________________________________________________
                          By Intervention group                      By Intervention group                     By Intervention group          
                _________________________________________  _________________________________________  ________________________________________
                  Control    MedDiet + Nuts MedDiet + VOO    Control    MedDiet + Nuts MedDiet + VOO    Control   MedDiet + Nuts MedDiet + VOO 
                   N=2042        N=2100        N=2182         N=1230        N=1132        N=1283         N=812        N=968          N=899     
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)   68.0 (5.96)   67.4 (5.57)    67.7 (5.84)   66.4 (6.62)  65.8 (6.40)    66.1 (6.61)  
Smoking:                                                                                                                                       
    Never       1282 (62.8%)  1259 (60.0%)  1351 (61.9%)   1077 (87.6%)  993 (87.7%)   1115 (86.9%)   205 (25.2%)  266 (27.5%)    236 (26.3%)  
    Current     270 (13.2%)   296 (14.1%)    292 (13.4%)    66 (5.37%)    54 (4.77%)    71 (5.53%)    204 (25.1%)  242 (25.0%)    221 (24.6%)  
    Former      490 (24.0%)   545 (26.0%)    539 (24.7%)    87 (7.07%)    85 (7.51%)    97 (7.56%)    403 (49.6%)  460 (47.5%)    442 (49.2%)  
Body mass index 30.3 (3.96)   29.7 (3.77)    29.9 (3.71)   30.8 (4.20)   30.2 (4.08)    30.4 (3.91)   29.6 (3.45)  29.1 (3.28)    29.2 (3.28)  
Hypertension:                                                                                                                                  
    No          331 (16.2%)   362 (17.2%)    396 (18.1%)   168 (13.7%)   147 (13.0%)    179 (14.0%)   163 (20.1%)  215 (22.2%)    217 (24.1%)  
    Yes         1711 (83.8%)  1738 (82.8%)  1786 (81.9%)   1062 (86.3%)  985 (87.0%)   1104 (86.0%)   649 (79.9%)  753 (77.8%)    682 (75.9%)  
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
\end{Soutput}
\end{Schunk}

By default the name of the table is displayed for each set of columns.

\begin{Schunk}
\begin{Sinput}
> cbind(alltab,femaletab,maletab)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table ---------

______________________________________________________________________________________________________________________________________________
                                 alltab                                    femaletab                                  maletab                 
                _________________________________________  _________________________________________  ________________________________________
                  Control    MedDiet + Nuts MedDiet + VOO    Control    MedDiet + Nuts MedDiet + VOO    Control   MedDiet + Nuts MedDiet + VOO 
                   N=2042        N=2100        N=2182         N=1230        N=1132        N=1283         N=812        N=968          N=899     
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
Age             67.3 (6.28)   66.7 (6.02)    67.0 (6.21)   68.0 (5.96)   67.4 (5.57)    67.7 (5.84)   66.4 (6.62)  65.8 (6.40)    66.1 (6.61)  
Smoking:                                                                                                                                       
    Never       1282 (62.8%)  1259 (60.0%)  1351 (61.9%)   1077 (87.6%)  993 (87.7%)   1115 (86.9%)   205 (25.2%)  266 (27.5%)    236 (26.3%)  
    Current     270 (13.2%)   296 (14.1%)    292 (13.4%)    66 (5.37%)    54 (4.77%)    71 (5.53%)    204 (25.1%)  242 (25.0%)    221 (24.6%)  
    Former      490 (24.0%)   545 (26.0%)    539 (24.7%)    87 (7.07%)    85 (7.51%)    97 (7.56%)    403 (49.6%)  460 (47.5%)    442 (49.2%)  
Body mass index 30.3 (3.96)   29.7 (3.77)    29.9 (3.71)   30.8 (4.20)   30.2 (4.08)    30.4 (3.91)   29.6 (3.45)  29.1 (3.28)    29.2 (3.28)  
Hypertension:                                                                                                                                  
    No          331 (16.2%)   362 (17.2%)    396 (18.1%)   168 (13.7%)   147 (13.0%)    179 (14.0%)   163 (20.1%)  215 (22.2%)    217 (24.1%)  
    Yes         1711 (83.8%)  1738 (82.8%)  1786 (81.9%)   1062 (86.3%)  985 (87.0%)   1104 (86.0%)   649 (79.9%)  753 (77.8%)    682 (75.9%)  
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
\end{Soutput}
\end{Schunk}
\end{landscape}
\
\\  

\noindent NOTE: The resulting object is of class {\tt cbind.createTable} and inherits also the class {\tt createTable}. This cannot be updated. It can be nicely printed on the R console and also exported to \LaTeX{} but it cannot be exported to CSV or HTML.
\
\\
\subsubsection{{\tt createTable} miscellaneous} \label{miscellaneous}

\paragraph{print} By default only the table with the descriptives is printed. With the \texttt{which.table} command it can be changed: \texttt{`avail'} returns data available and \texttt{'both'} returns both tables:

\begin{Schunk}
\begin{Sinput}
> print(createTable(compareGroups(group ~ age + sex + smoke + waist + hormo,
+                                 data=predimed)), which.table='both')
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

________________________________________________________________________________ 
                               Control    MedDiet + Nuts MedDiet + VOO p.overall 
                                N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                    <0.001   
    Male                     812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female                   1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Smoking:                                                                 0.444   
    Never                    1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
    Current                  270 (13.2%)   296 (14.1%)    292 (13.4%)            
    Former                   490 (24.0%)   545 (26.0%)    539 (24.7%)            
Waist circumference           101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                             0.850   
    No                       1811 (98.3%)  1835 (98.4%)  1918 (98.2%)            
    Yes                       31 (1.68%)    30 (1.61%)    36 (1.84%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 



---Available data----

_______________________________________________________________________________________________ 
                            [ALL] Control MedDiet + Nuts MedDiet + VOO      method       select 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                         6324   2042        2100          2182      continuous-normal  ALL   
Sex                         6324   2042        2100          2182         categorical     ALL   
Smoking                     6324   2042        2100          2182         categorical     ALL   
Waist circumference         6324   2042        2100          2182      continuous-normal  ALL   
Hormone-replacement therapy 5661   1842        1865          1954         categorical     ALL   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
With the \texttt{print} command setting \texttt{nmax} option = FALSE, the total maximum ``n'' in the available data is omitted in the first row.
\begin{Schunk}
\begin{Sinput}
> print(createTable(compareGroups(group ~ age + sex + smoke + waist + hormo,
+                                 data=predimed)),  nmax=FALSE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

________________________________________________________________________________ 
                               Control    MedDiet + Nuts MedDiet + VOO p.overall 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                    <0.001   
    Male                     812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female                   1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Smoking:                                                                 0.444   
    Never                    1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
    Current                  270 (13.2%)   296 (14.1%)    292 (13.4%)            
    Former                   490 (24.0%)   545 (26.0%)    539 (24.7%)            
Waist circumference           101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                             0.850   
    No                       1811 (98.3%)  1835 (98.4%)  1918 (98.2%)            
    Yes                       31 (1.68%)    30 (1.61%)    36 (1.84%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\paragraph{summary} returns the same table as that generated with \texttt{print} 
command setting {\tt which.table='avail'}:

\begin{Schunk}
\begin{Sinput}
> summary(createTable(compareGroups(group ~ age + sex + smoke + waist + hormo, 
+                                   data=predimed)))
\end{Sinput}
\begin{Soutput}
---Available data----

_______________________________________________________________________________________________ 
                            [ALL] Control MedDiet + Nuts MedDiet + VOO      method       select 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                         6324   2042        2100          2182      continuous-normal  ALL   
Sex                         6324   2042        2100          2182         categorical     ALL   
Smoking                     6324   2042        2100          2182         categorical     ALL   
Waist circumference         6324   2042        2100          2182      continuous-normal  ALL   
Hormone-replacement therapy 5661   1842        1865          1954         categorical     ALL   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\paragraph{update} An object of class {\tt createTable} can be updated:

\begin{Schunk}
\begin{Sinput}
> res<-compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed)
> restab<-createTable(res, type=1, show.ratio=TRUE )
> restab
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

_______________________________________________________________________________ 
                               Control   MedDiet + Nuts MedDiet + VOO p.overall 
                               N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)  66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                   <0.001   
    Male                        39.8%        46.1%          41.2%               
    Female                      60.2%        53.9%          58.8%               
Smoking:                                                                0.444   
    Never                       62.8%        60.0%          61.9%               
    Current                     13.2%        14.1%          13.4%               
    Former                      24.0%        26.0%          24.7%               
Waist circumference          101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                            0.850   
    No                          98.3%        98.4%          98.2%               
    Yes                         1.68%        1.61%          1.84%               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\begin{Sinput}
> update(restab, show.n=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

____________________________________________________________________________________ 
                               Control   MedDiet + Nuts MedDiet + VOO p.overall  N   
                               N=2042        N=2100        N=2182                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)  66.7 (6.02)    67.0 (6.21)    0.003   6324 
Sex:                                                                   <0.001   6324 
    Male                        39.8%        46.1%          41.2%                    
    Female                      60.2%        53.9%          58.8%                    
Smoking:                                                                0.444   6324 
    Never                       62.8%        60.0%          61.9%                    
    Current                     13.2%        14.1%          13.4%                    
    Former                      24.0%        26.0%          24.7%                    
Waist circumference          101 (10.8)    100 (10.6)    100 (10.4)     0.045   6324 
Hormone-replacement therapy:                                            0.850   5661 
    No                          98.3%        98.4%          98.2%                    
    Yes                         1.68%        1.61%          1.84%                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

In just one statement it is possible to update an object of class 
\texttt{compareGroups} and \texttt{createTable}:

\begin{Schunk}
\begin{Sinput}
> update(restab, x = update(res, subset=c(sex=='Female')), show.n=TRUE)
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

____________________________________________________________________________________ 
                               Control   MedDiet + Nuts MedDiet + VOO p.overall  N   
                               N=1230        N=1132        N=1283                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          68.0 (5.96)  67.4 (5.57)    67.7 (5.84)    0.056   3645 
Sex: Female                     100%          100%          100%          .     3645 
Smoking:                                                                0.907   3645 
    Never                       87.6%        87.7%          86.9%                    
    Current                     5.37%        4.77%          5.53%                    
    Former                      7.07%        7.51%          7.56%                    
Waist circumference          99.0 (11.0)  97.8 (11.0)    98.0 (10.5)    0.016   3645 
Hormone-replacement therapy:                                            0.898   3459 
    No                          97.4%        97.2%          97.0%                    
    Yes                         2.64%        2.81%          2.95%                    
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that the \texttt{compareGroups} object (\textit{res}) is updated, 
selecting only 'Female' participants, 
and the \texttt{createTable} object (\textit{restab}) is updated to add a 
column with the maximum available data for each explanatory variable.\\

\paragraph{subsetting} Objects from \texttt{createTable} function can also be 
subsetted using ``['':

\begin{Schunk}
\begin{Sinput}
> createTable(compareGroups(group ~ age + sex + smoke + waist + hormo, data=predimed))
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

________________________________________________________________________________ 
                               Control    MedDiet + Nuts MedDiet + VOO p.overall 
                                N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                          67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                                    <0.001   
    Male                     812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female                   1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
Smoking:                                                                 0.444   
    Never                    1282 (62.8%)  1259 (60.0%)  1351 (61.9%)            
    Current                  270 (13.2%)   296 (14.1%)    292 (13.4%)            
    Former                   490 (24.0%)   545 (26.0%)    539 (24.7%)            
Waist circumference           101 (10.8)    100 (10.6)    100 (10.4)     0.045   
Hormone-replacement therapy:                                             0.850   
    No                       1811 (98.3%)  1835 (98.4%)  1918 (98.2%)            
    Yes                       31 (1.68%)    30 (1.61%)    36 (1.84%)             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> createTable(compareGroups(group ~ age + sex + bmi, data=predimed))[1:2, ]
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'Intervention group'---------

______________________________________________________________ 
             Control    MedDiet + Nuts MedDiet + VOO p.overall 
              N=2042        N=2100        N=2182               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age        67.3 (6.28)   66.7 (6.02)    67.0 (6.21)    0.003   
Sex:                                                  <0.001   
    Male   812 (39.8%)   968 (46.1%)    899 (41.2%)            
    Female 1230 (60.2%)  1132 (53.9%)  1283 (58.8%)            
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}
\
\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Exporting tables} \label{exporting} 

Tables can be exported to CSV, HTML or \LaTeX{}:

\begin{itemize*}
\item export2csv(restab, file="table1"), exports to CSV format
\item export2html(restab, file="table1"), exports to HTML format
\item export2latex(restab, file="table1"), exports to \LaTeX{} format
\end{itemize*}

File extensions are added automatically. Only the filename is needed (and the path if necessary) without the extension. \\
\
\\

%%%%%%%%%
\subsubsection{General exporting options} \label{exportoption}

\paragraph{which.table} By default only the table with the descriptives is 
exported. This can be changed with the \texttt{which.table} command: 
\texttt{`avail'} exports only available data and \texttt{'both'} both tables.
\
\\

\paragraph{nmax} By default a first row with the maximum ``n'' for available data (i.e. the number of participants minus the least missing data) is exported. Stating \texttt{nmax} = FALSE this first row is omitted.
\
\\

\paragraph{sep} Only relevant when table is exported to csv. Stating, for example, \texttt{sep} = ``;'' table will be exported to csv with columns separated by ``;''
\
\\

%%%%%%%%%%
\subsubsection{Exporting to \LaTeX{}} \label{exportolatex}

A special case of exporting is when tables are exported to \LaTeX{}. The function \texttt{export2latex} returns an object with the tex code as a character that can be changed in the \Rlogo~ session.
\
\\

\paragraph{file} If the {\tt file} argument in \texttt{export2latex} is missing, the code is printed in the \Rlogo~ console. This can be useful when \Rlogo~ code is inserted in a \LaTeX{} document chunk to be processed with {\tt Sweave}.

\begin{Schunk}
\begin{Sinput}
> restab<-createTable(compareGroups(group ~ age + sex + smoke + waist + hormo, 
+                                   data=predimed))
> export2latex(restab)
\end{Sinput}
\begin{Soutput}
    \begin{longtable}{lcccc}\caption{Summary descriptives table by groups of `Intervention group'}\\
    \hline  
     &   Control    & MedDiet + Nuts & MedDiet + VOO & \multirow{2}{*}{p.overall}\\ 
 &    N=2042    &     N=2100     &    N=2182     &           \\ 
  
    \hline
    \hline     
    \endfirsthead 
    \multicolumn{5}{l}{\tablename\ \thetable{} \textit{-- continued from previous page}}\\ 
    \hline
     &   Control    & MedDiet + Nuts & MedDiet + VOO & \multirow{2}{*}{p.overall}\\ 
 &    N=2042    &     N=2100     &    N=2182     &           \\ 

    \hline
    \hline  
    \endhead   
    \hline
    \multicolumn{5}{l}{\textit{continued on next page}} \\ 
    \endfoot   
    \multicolumn{5}{l}{}  \\ 
    \endlastfoot 
    Age & 67.3 (6.28)  &  66.7 (6.02)   &  67.0 (6.21)  &   0.003  \\ 
Sex: &              &                &               &  $<$0.001  \\ 
$\qquad$Male & 812 (39.8\%)  &  968 (46.1\%)   &  899 (41.2\%)  &          \\ 
$\qquad$Female & 1230 (60.2\%) &  1132 (53.9\%)  & 1283 (58.8\%)  &          \\ 
Smoking: &              &                &               &   0.444  \\ 
$\qquad$Never & 1282 (62.8\%) &  1259 (60.0\%)  & 1351 (61.9\%)  &          \\ 
$\qquad$Current & 270 (13.2\%)  &  296 (14.1\%)   &  292 (13.4\%)  &          \\ 
$\qquad$Former & 490 (24.0\%)  &  545 (26.0\%)   &  539 (24.7\%)  &          \\ 
Waist circumference &  101 (10.8)  &   100 (10.6)   &  100 (10.4)   &   0.045  \\ 
Hormone-replacement therapy: &              &                &               &   0.850  \\ 
$\qquad$No & 1811 (98.3\%) &  1835 (98.4\%)  & 1918 (98.2\%)  &          \\ 
$\qquad$Yes &  31 (1.68\%)  &   30 (1.61\%)   &  36 (1.84\%)   &           \\ 
 
    \hline
    \end{longtable} 
\end{Soutput}
\end{Schunk}
\
\\

\paragraph{size} The font size of exported tables can be changed by this option. Possible values are 'tiny', 'scriptsize', 'footnotesize', 'small', 'normalsize', 'large', 'Large', 'LARGE','huge', 'Huge' or 'same'. Default is 'same', which means that font size of the table is the same as specified in the main \LaTeX{} document where the table will be inserted.   \\
\
\\

\paragraph{caption} The table caption for descriptives table and available data table. If which.table='both' the first element of 'caption' will be assigned to descriptives table and the second to available data table. If it is set to `', no caption is inserted. Default value is NULL, which writes 'Summary descriptives table by groups of 'y'' for descriptives table and 'Available data by groups of 'y'' for the available data table.\\
\
\\
 
\paragraph{loc.caption} Table caption location. Possible values are 'top' or 'bottom'. Default value is 'top'.  \\
\
\\

\paragraph{label} Used to cite tables in a \LaTeX{} document. If {\tt which.table}='both' the first element of 'label' will be assigned to the descriptives table and the second to the available data table. Default value is {\tt NULL}, which assigns no label to the table/s.    \\
\
\\

\paragraph{landscape} Table is placed in horizontal way. This option is specially usefull when table contains many columns and/or they are too wide to be placed vertically. \\
\
\\



%%%%
\subsubsection{Generating an exhaustive report} \label{report}

In the version 2.0 of {\tt compareGroups} package, a new function called `report' has been created. This function automatically generates a PDF document with the descriptive table as well as the corresponding `available' table. In addition, plots of all analysed variables are shown.
\\

In order to make easier to `navigate' throught the document, an index with hyperlinks is inserted in the document.\\

See the help file of this function where you can find an example with the REGICOR data (the other example data set contained in the {\tt compareGroups} package)

\begin{Schunk}
\begin{Sinput}
> ?report   # to know more about report function
> ?regicor  # info about REGICOR data set
\end{Sinput}
\end{Schunk}



%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Missing values} \label{missing}

Many times, it is important to be aware of the missingness contained in each variable, possibly by groups.
Althought `available' table shows the number of the non-missing values for each row-variable and in each group, it would be desirable to test whether the frequency of non-available data is different between groups.
For this porpose, a new function has been implemented in the {\tt compareGroups} package, which is called `missingTable'. This function applies to both {\tt compareGroups} and {\tt createTable} class objects. This last option is useful when the table is already created. To illustrate it, we will use the REGICOR data set, comparing missing rates of all variables by year:

\begin{Schunk}
\begin{Sinput}
> # from a compareGroups object
> data(regicor)
> res <- compareGroups(year ~ .-id, regicor)
> missingTable(res)
\end{Sinput}
\begin{Soutput}
--------Missingness table by 'Recruitment year'---------

____________________________________________________________________________________________ 
                                                    1995       2000        2005    p.overall 
                                                   N=431       N=786      N=1077             
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Age                                              0 (0.00%)   0 (0.00%)  0 (0.00%)    1.000   
Sex                                              0 (0.00%)   0 (0.00%)  0 (0.00%)    1.000   
Smoking status                                   16 (3.71%) 28 (3.56%)  17 (1.58%)   0.010   
Systolic blood pressure                          3 (0.70%)  11 (1.40%)  0 (0.00%)   <0.001   
Diastolic blood pressure                         3 (0.70%)  11 (1.40%)  0 (0.00%)   <0.001   
History of hypertension                          0 (0.00%)   0 (0.00%)  8 (0.74%)    0.015   
Hypertension treatment                           0 (0.00%)   0 (0.00%)  43 (3.99%)  <0.001   
Total cholesterol                                28 (6.50%) 71 (9.03%)  2 (0.19%)   <0.001   
HDL cholesterol                                  30 (6.96%) 38 (4.83%)  1 (0.09%)   <0.001   
Triglycerides                                    28 (6.50%) 34 (4.33%)  1 (0.09%)   <0.001   
LDL cholesterol                                  43 (9.98%) 98 (12.5%)  27 (2.51%)  <0.001   
History of hyperchol.                            0 (0.00%)  15 (1.91%)  6 (0.56%)    0.001   
Cholesterol treatment                            0 (0.00%)  13 (1.65%)  42 (3.90%)  <0.001   
Height (cm)                                      8 (1.86%)  15 (1.91%)  12 (1.11%)   0.318   
Weight (Kg)                                      8 (1.86%)  15 (1.91%)  12 (1.11%)   0.318   
Body mass index                                  8 (1.86%)  15 (1.91%)  12 (1.11%)   0.318   
Physical activity (Kcal/week)                    64 (14.8%) 22 (2.80%)  2 (0.19%)   <0.001   
Physical component                               34 (7.89%) 123 (15.6%) 83 (7.71%)  <0.001   
Mental component                                 34 (7.89%) 123 (15.6%) 83 (7.71%)  <0.001   
Cardiovascular event                             33 (7.66%) 45 (5.73%)  53 (4.92%)   0.118   
Days to cardiovascular event or end of follow-up 33 (7.66%) 45 (5.73%)  53 (4.92%)   0.118   
Overall death                                    44 (10.2%) 48 (6.11%)  54 (5.01%)   0.001   
Days to overall death or end of follow-up        44 (10.2%) 48 (6.11%)  54 (5.01%)   0.001   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> # or from createTable objects
> restab <- createTable(res, hide.no = 'no')
> missingTable(restab)
\end{Sinput}
\end{Schunk}


Perhaps a NA value of a categorical variable may mean something different from just non available. For example, patients admitted for Coronary Acute Syndrome with NA in ST elevation may have a higher risk of in-hospital death than the ones with available data, i.e. ST elevation yes or not. If these kind of variables are introduced in the data set as NA, they are removed from the analysis. To avoid the user having to recode NA as a new category for all categorical variables, new argument called `include.miss' in {\tt compareGroups} has been implemented which does it automatically. Let's see an example with all variables from REGICOR data set by cardiovascular event.

\begin{Schunk}
\begin{Sinput}
> # first create time-to-cardiovascular event
> regicor$tcv<-with(regicor,Surv(tocv,cv=='Yes'))
> # create the table
> res <- compareGroups(tcv ~ . -id-tocv-cv-todeath-death, regicor, include.miss = TRUE)
> restab <- createTable(res, hide.no = 'no')
> restab
\end{Sinput}
\begin{Soutput}
--------Summary descriptives table by 'tcv'---------

________________________________________________________________ 
                                No event      Event    p.overall 
                                 N=2071       N=92               
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
Recruitment year:                                        0.157   
    1995                      388 (18.7%)  10 (10.9%)            
    2000                      706 (34.1%)  35 (38.0%)            
    2005                      977 (47.2%)  47 (51.1%)            
Age                           54.6 (11.1)  57.5 (11.0)   0.021   
Sex:                                                     0.696   
    Male                      996 (48.1%)  46 (50.0%)            
    Female                    1075 (51.9%) 46 (50.0%)            
Smoking status:                                         <0.001   
    Never smoker              1099 (53.1%) 37 (40.2%)            
    Current or former < 1y    506 (24.4%)  47 (51.1%)            
    Former >= 1y              419 (20.2%)   8 (8.70%)            
    <Missing>                  47 (2.27%)   0 (0.00%)            
Systolic blood pressure        131 (20.3)  138 (21.5)    0.001   
Diastolic blood pressure      79.5 (10.4)  82.9 (12.3)   0.002   
History of hypertension:                                 0.118   
    Yes                       647 (31.2%)  38 (41.3%)            
    No                        1418 (68.5%) 54 (58.7%)            
    <Missing>                  6 (0.29%)    0 (0.00%)            
Hypertension treatment:                                  0.198   
    No                        1657 (80.0%) 70 (76.1%)            
    Yes                       382 (18.4%)  22 (23.9%)            
    <Missing>                  32 (1.55%)   0 (0.00%)            
Total cholesterol              218 (44.5)  224 (50.4)    0.207   
HDL cholesterol               52.8 (14.8)  50.4 (13.3)   0.114   
Triglycerides                  113 (68.2)  123 (52.4)    0.190   
LDL cholesterol                143 (39.6)  149 (45.6)    0.148   
History of hyperchol.:                                   0.470   
    Yes                       639 (30.9%)  25 (27.2%)            
    No                        1414 (68.3%) 67 (72.8%)            
    <Missing>                  18 (0.87%)   0 (0.00%)            
Cholesterol treatment:                                   0.190   
    No                        1817 (87.7%) 86 (93.5%)            
    Yes                       213 (10.3%)   6 (6.52%)            
    <Missing>                  41 (1.98%)   0 (0.00%)            
Height (cm)                    163 (9.21)  163 (9.34)    0.692   
Weight (Kg)                   73.4 (13.7)  74.9 (12.8)   0.294   
Body mass index               27.6 (4.56)  28.1 (4.48)   0.299   
Physical activity (Kcal/week)  405 (397)    338 (238)    0.089   
Physical component            49.7 (8.95)  47.4 (9.03)   0.023   
Mental component              48.1 (10.9)  46.3 (12.2)   0.122   
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}


%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Analysis of genetic data} \label{genetic}


In the version 2.0 of {\tt compareGroups}, it is possible to analyse genetic data, more concretely Single Nucleotic Polymorphisms (SNPs), using the function {\tt compareSNPs}. This function takes advantage of {\tt SNPassoc}\cite{SNPassoc} and {\tt HardyWeinberg} \cite{HW} packages to perform quality control of genetic data displaying the Minor Allele Frequencies, Missingness, Hardy Weinberg Equilibrium, etc. of the whole data set or by groups. When groups are considered, it also performs a test to check whether missingness rates is the same among groups.\\


\noindent Following, we illustrate this by an example taking a data set from {\tt SNPassoc} package. 
\\

\noindent First of all, load the {\tt SNPs} data from {\tt SNPassoc}, and visualize the first rows. Notice how are the SNPs coded, i.e. by the alleles. The alleles separator can be any character. If so, this must be specified in the `sep' argument of {\tt compareSNPs} function (see {\tt ?compareSNPs} for more details).
\begin{Schunk}
\begin{Sinput}
> data(SNPs)
> head(SNPs)
\end{Sinput}
\begin{Soutput}
  id casco    sex blood.pre  protein snp10001 snp10002 snp10003 snp10004 snp10005 snp10006 snp10007
1  1     1 Female      13.7 75640.52       TT       CC       GG       GG       GG       AA       CC
2  2     1 Female      12.7 28688.22       TT       AC       GG       GG       AG       AA       CC
3  3     1 Female      12.9 17279.59       TT       CC       GG       GG       GG       AA       CC
4  4     1   Male      14.6 27253.99       CT       CC       GG       GG       GG       AA       CC
5  5     1 Female      13.4 38066.57       TT       AC       GG       GG       GG       AA       CC
6  6     1 Female      11.3  9872.46       TT       CC       GG       GG       GG       AA       CC
  snp10008 snp10009 snp100010 snp100011 snp100012 snp100013 snp100014 snp100015 snp100016 snp100017
1       CC       AA        TT        GG        GG        AA        AA        GG        GG        TT
2       CC       AG        TT        GG        CG        AA        AC        GG        GG        CT
3       CC       AA        TT        CC        GG        AA        CC        GG        GG        TT
4       CC       AA        TT        GG        GG        AA        AC        GG        GG        TT
5       CC       AG        TT        GG        GG        AA        AC        GG        GG        CT
6       CC       AA        TT        GG        GG        AA        AA        GG        GG        TT
  snp100018 snp100019 snp100020 snp100021 snp100022 snp100023 snp100024 snp100025 snp100026
1        TT        CC        GG        GG        AA        TT        TT        CC        GG
2        CT        CG        GG        GG        AA        AT        TT        CC        GG
3        TT        CC        GG        GG        AA        TT        TT        CC        GG
4        TT        CG        GG        GG        AA        TT        CT        CC        GG
5        CT        CG        GG        GG        AA        AT        TT        CC        GG
6        TT        CC        GG        GG        AA        TT        TT        CC        GG
  snp100027 snp100028 snp100029 snp100030 snp100031 snp100032 snp100033 snp100034 snp100035
1        CC        CC        GG        AA        TT        AA        AA        TT        TT
2        CG        CT        GG        AA        TT        AG        AG        TT        TT
3        CC        CC        GG        AA        TT        AA        AA        TT        TT
4        CC        CT        AG        AA        TT        AG        AG        CT        TT
5        CG        CT        GG        AA        TT        AG        AG        TT        TT
6        CC        CC        GG        AA        TT        AA        AA        TT      <NA>
\end{Soutput}
\end{Schunk}

In this data frame there are some genetic and non-genetic data. Genetic variables are those whose names begin with `snp'. If we want to summarize the first three SNPs by case control status:

\begin{Schunk}
\begin{Sinput}
> res<-compareSNPs(casco ~ snp10001 + snp10002 + snp10003, data=SNPs)
> res
\end{Sinput}
\begin{Soutput}
*********** Summary of genetic data (SNPs) by groups ***********


  *** casco = '0' ***

_____________________________________________________ 
SNP      Ntyped    MAF Genotypes    Genotypes.p HWE.p 
===================================================== 
snp10001     47  26.6%  TT|TC|CC  51.1|44.7|4.3 0.487 
snp10002     47  26.6%  CC|CA|AA  46.8|53.2|0.0 0.029 
snp10003     44 100.0%        GG 100.0| 0.0|0.0 1.000 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 


  *** casco = '1' ***

_____________________________________________________ 
SNP      Ntyped    MAF Genotypes    Genotypes.p HWE.p 
===================================================== 
snp10001    110  23.6%  TT|TC|CC  61.8|29.1|9.1 0.069 
snp10002    110  28.6%  CC|CA|AA  47.3|48.2|4.5 0.091 
snp10003    100 100.0%        GG 100.0| 0.0|0.0 1.000 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 


  *** Missingness test ***

________________ 
snps     p.value 
================ 
snp10001   1.000 
snp10002   1.000 
snp10003   0.756 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}

Note that all variables specified in the right hand side of the formula must be SNPs, i.e. variables whose levels or codes can be interpreted as genotypes (see {\tt setupSNPs} function from {\tt SNPassoc} package for more information).
Separated summary tables by groups of cases and controls are displayed, and the last table corresponds to missingness test comparing non-available rates among groups.\\

If summarizing SNPs in the whole data set is desired, without separating by groups, leave the left side of formula in blank, as in {\tt compareGroups} function. In this case, a single table is displayed and no missingness test is performed.

\begin{Schunk}
\begin{Sinput}
> res<-compareSNPs(~ snp10001 + snp10002 + snp10003, data=SNPs)
> res
\end{Sinput}
\begin{Soutput}
*********** Summary of genetic data (SNPs) ***********
_____________________________________________________ 
SNP      Ntyped    MAF Genotypes    Genotypes.p HWE.p 
===================================================== 
snp10001    157  24.5%  TT|TC|CC  58.6|33.8|7.6 0.353 
snp10002    157  28.0%  CC|CA|AA  47.1|49.7|3.2 0.006 
snp10003    144 100.0%        GG 100.0| 0.0|0.0 1.000 
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ 
\end{Soutput}
\end{Schunk}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Using GUI} \label{gui}

Once the {\tt compareGroups} package is loaded, a Graphical User Interface (GUI) is displayed in response to typing {\tt cGroupsGUI()}. The GUI is meant to make it feasible for users who are unfamiliar with \Rlogo~ to construct bivariate tables.
\\

In this section we illustrate, step by step, how to construct a bivariate table containing descriptives by groups from the \textit{predimed} data  using the GUI:
  
%\begin{center}
%\small
%\input{./tables/gui_example.tex}
%\normalsize
%\end{center}
    \begin{longtable}{lcccc}\caption{Summary descriptives table by groups of `Intervention group'}\\
    \hline  
     &   Control    & MedDiet + Nuts & MedDiet + VOO & \multirow{2}{*}{p.overall}\\ 
 &    N=2042    &     N=2100     &    N=2182     &           \\ 
  
    \hline
    \hline     
    \endfirsthead 
    \multicolumn{5}{l}{\tablename\ \thetable{} \textit{-- continued from previous page}}\\ 
    \hline
     &   Control    & MedDiet + Nuts & MedDiet + VOO & \multirow{2}{*}{p.overall}\\ 
 &    N=2042    &     N=2100     &    N=2182     &           \\ 

    \hline
    \hline  
    \endhead   
    \hline
    \multicolumn{5}{l}{\textit{continued on next page}} \\ 
    \endfoot   
    \multicolumn{5}{l}{}  \\ 
    \endlastfoot 
    Age & 67.3 (6.28)  &  66.7 (6.02)   &  67.0 (6.21)  &   0.003  \\ 
Sex: Female & 1230 (60.2\%) &  1132 (53.9\%)  & 1283 (58.8\%)  &  $<$0.001  \\ 
Smoking: &              &                &               &   0.444  \\ 
$\qquad$Never & 1282 (62.8\%) &  1259 (60.0\%)  & 1351 (61.9\%)  &          \\ 
$\qquad$Current & 270 (13.2\%)  &  296 (14.1\%)   &  292 (13.4\%)  &          \\ 
$\qquad$Former & 490 (24.0\%)  &  545 (26.0\%)   &  539 (24.7\%)  &          \\ 
Body mass index & 30.3 (3.96)  &  29.7 (3.77)   &  29.9 (3.71)  &  $<$0.001  \\ 
Waist circumference &  101 (10.8)  &   100 (10.6)   &  100 (10.4)   &   0.045  \\ 
Waist-to-height ratio & 0.63 (0.07)  &  0.62 (0.06)   &  0.63 (0.06)  &  $<$0.001  \\ 
Hypertension & 1711 (83.8\%) &  1738 (82.8\%)  & 1786 (81.9\%)  &   0.249  \\ 
Type-2 diabetes & 970 (47.5\%)  &  950 (45.2\%)   & 1082 (49.6\%)  &   0.017  \\ 
Dyslipidemia & 1479 (72.4\%) &  1539 (73.3\%)  & 1560 (71.5\%)  &   0.423  \\ 
Family history of premature CHD & 462 (22.6\%)  &  460 (21.9\%)   &  507 (23.2\%)  &   0.581  \\ 
Hormone-replacement therapy &  31 (1.68\%)  &   30 (1.61\%)   &  36 (1.84\%)   &   0.850  \\ 
MeDiet Adherence score & 8.44 (1.94)  &  8.81 (1.90)   &  8.77 (1.97)  &  $<$0.001  \\ 
follow-up to main event (years) & 4.09 (1.74)  &  4.31 (1.70)   &  4.64 (1.60)  &  $<$0.001  \\ 
AMI, stroke, or CV Death &  97 (4.75\%)  &   70 (3.33\%)   &  85 (3.90\%)   &   0.064   \\ 
 
    \hline
    \end{longtable} 
\newpage

\begin{itemize}

\item[Step 1.] Browse for and select the data to be loaded. Valid file types include SPSS or \Rlogo~ format, CSV plain text file or a \textit{data.frame} already existing in the Workspace. By default, the \textit{predimed} example data is loaded when the GUI is opened.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step1_load_data.JPG}
\end{center}


\item[Step 2.] Choose the variables to be described (row-variables).
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step2_select_row_variables.png}
\end{center}

\newpage
\item[Step 3.] If descriptives by group are desired (for example), move the variable \textit{group} to the GUI top frame, making it the factor variable. To report descriptives for the whole sample (i.e., no groups), click on the 'none' button.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step3_select_group_variable.png}
\end{center}

\item[Step 4.] It is possible to hide the first, last or no categories of a categorical row-variable. In this example, 'Male' levels will be hidden for Sex; conversely, all categories will be shown for other categorical variables. 
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step4_hide_categ.png}
\end{center}

\newpage

\item[Step 5.] For each continuous variable, it is possible to specify whether to treat it as normal or non-normal or to transform a numerical variable into a categorical one. This last option can be interesting if a categorical variable has been coded as numerical. By default, all continuous variables are treated as normal. In this example, Waist circumference will be treated as non-normal, i.e., median and quartiles will be reported instead of mean and standard deviation.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step5_select_method.png}
\end{center}

\item[Step 6.] For each row-variable, it is possible to select a subset of individuals from the data set to be included. In this example, descriptives of Body mass index, Waist circumference and Waist-to-height ratio will be reported only for Female participants. Also, it is possible to specify criteria to select a subset of individuals to be included for all row-variables: type the logical condition (selection criteria of individuals) on the 'Global subset' window instead of 'Variable subset'.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step6_subsetting.png}
\end{center}


\newpage

\item[Step 7.] Some bivariate table characteristics can be set by clicking on 'Report options' from the main menu, such as to report descriptives (mean, frequencies, medians, etc.), display the p-trend, and show only relative frequencies.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step7_report_options.png}
\end{center}

\item[Step 8.] Finally, specify the bivariate table format (\LaTeX{}, CVS plain text or HTML). Clicking on 'print' will then display the bivariate table, as well as a summary (available data, etc.), on the \Rlogo~ console. The table can also be exported to the file formats listed.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/step8_export_table.png}
\end{center}

\end{itemize}

%%%%%%%%%%%%%%%%
  \newpage
\subsection{Computing Odds Ratio}

For a case-control study, it may be necessary to report the Odds Ratio between cases and controls for each variable. The table below contains Odds Ratios for each row-variable by hypertension status.

    \begin{longtable}{lccc}\caption{Summary descriptives table by groups of `Hypertension'}\\
    \hline  
     &        OR        & p.ratio & p.overall \\ 
  
    \hline
    \hline     
    \endfirsthead 
    \multicolumn{4}{l}{\tablename\ \thetable{} \textit{-- continued from previous page}}\\ 
    \hline
     &        OR        & p.ratio & p.overall \\ 

    \hline
    \hline  
    \endhead   
    \hline
    \multicolumn{4}{l}{\textit{continued on next page}} \\ 
    \endfoot   
    \multicolumn{4}{l}{}  \\ 
    \endlastfoot 
    Age & 1.04 [1.03;1.05] & $<$0.001  &  $<$0.001  \\ 
Sex: Female & 1.82 [1.60;2.08] &  0.000  &  $<$0.001  \\ 
Smoking: &                  &         &  $<$0.001  \\ 
$\qquad$Never &       Ref.       &  Ref.   &          \\ 
$\qquad$Current & 0.43 [0.36;0.51] &  0.000  &          \\ 
$\qquad$Former & 0.63 [0.54;0.73] & $<$0.001  &          \\ 
Body mass index & 1.10 [1.08;1.12] & $<$0.001  &  $<$0.001  \\ 
Waist circumference & 1.01 [1.01;1.02] & $<$0.001  &  $<$0.001  \\ 
Waist-to-height ratio & 71.5 [25.6;199]  & $<$0.001  &  $<$0.001  \\ 
Type-2 diabetes & 0.25 [0.22;0.29] &  0.000  &  $<$0.001  \\ 
Dyslipidemia & 1.75 [1.53;2.01] & $<$0.001  &  $<$0.001  \\ 
Family history of premature CHD & 0.87 [0.75;1.01] &  0.070  &   0.074  \\ 
Hormone-replacement therapy & 1.08 [0.64;1.97] &  0.773  &   0.856  \\ 
MeDiet Adherence score & 0.96 [0.93;1.00] &  0.028  &   0.029  \\ 
follow-up to main event (years) & 0.94 [0.90;0.98] &  0.002  &   0.001  \\ 
AMI, stroke, or CV Death & 1.04 [0.75;1.48] &  0.826  &   0.879   \\ 
 
    \hline
    \end{longtable} To build this table, as illustrated in the screens below, you would select \textit{htn} variable (Hypertension status) as the factor variable, indicate 'no' category on the 'reference' pull-down menu, and mark 'Show odds/hazard ratio' in the 'Report Options' menu before exporting the table.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/or_rr.png}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsection{Computing Hazard Ratio}

In a cohort study, it may be more informative to compute hazard ratio taking into account time-to-event.


    \begin{longtable}{lccccc}\caption{Summary descriptives table by groups of `AMI, stroke, or CV Death'}\\
    \hline  
     &   No event   &    Event    & \multirow{2}{*}{       HR       } & \multirow{2}{*}{p.ratio} & \multirow{2}{*}{p.overall}\\ 
 &    N=6072    &    N=252    &                  &         &           \\ 
  
    \hline
    \hline     
    \endfirsthead 
    \multicolumn{6}{l}{\tablename\ \thetable{} \textit{-- continued from previous page}}\\ 
    \hline
     &   No event   &    Event    & \multirow{2}{*}{       HR       } & \multirow{2}{*}{p.ratio} & \multirow{2}{*}{p.overall}\\ 
 &    N=6072    &    N=252    &                  &         &           \\ 

    \hline
    \hline  
    \endhead   
    \hline
    \multicolumn{6}{l}{\textit{continued on next page}} \\ 
    \endfoot   
    \multicolumn{6}{l}{}  \\ 
    \endlastfoot 
    Intervention group: &              &             &                  &         &   0.011  \\ 
$\qquad$Control & 1945 (32.0\%) & 97 (38.5\%)  &       Ref.       &  Ref.   &          \\ 
$\qquad$MedDiet + Nuts & 2030 (33.4\%) & 70 (27.8\%)  & 0.66 [0.48;0.89] &  0.008  &          \\ 
$\qquad$MedDiet + VOO & 2097 (34.5\%) & 85 (33.7\%)  & 0.70 [0.53;0.94] &  0.018  &          \\ 
Age & 66.9 (6.14)  & 69.4 (6.65) & 1.06 [1.04;1.09] & $<$0.001  &  $<$0.001  \\ 
Sex: &              &             &                  &         &  $<$0.001  \\ 
$\qquad$Male & 2528 (41.6\%) & 151 (59.9\%) &       Ref.       &  Ref.   &          \\ 
$\qquad$Female & 3544 (58.4\%) & 101 (40.1\%) & 0.49 [0.38;0.63] & $<$0.001  &           \\ 
 
    \hline
    \end{longtable} To generate this table, select \textit{toevent} variable and \textit{event}, indicating the time-to-event and the status, respectively, and select the event category for the status variable. Finally, as for Odds Ratios, mark 'Show odds/hazard ratio' in the 'Report Options' menu before exporting the table.
\begin{center}
\includegraphics[width=1\textwidth]{./figures/GUI/toevent.png}
\end{center}


\vspace{1cm}
To return to the \Rlogo~ console, just close the GUI window.

\newpage
\section*{Bibliography}
%\bibliographystyle{bmc_article}  % Style BST file
\bibliographystyle{plain}  % Style BST file
\bibliography{compareGroups_vignette}

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
